<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Mocify - API Mock Server</title>
        <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
        <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
        <script src="https://cdn.tailwindcss.com"></script>
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
        />
    </head>
    <body class="bg-gray-900 text-gray-100">
        <div id="root"></div>

        <script>
            console.log("Script starting to load...");
            const { useState, useEffect } = React;
            const { createRoot } = ReactDOM;
            console.log("React hooks loaded");

            // Mock Tauri API for demonstration
            // Mock data storage
            const mockStorage = {
                collections: [
                    {
                        id: "1",
                        name: "User API",
                        description: "Mock user endpoints",
                        port: 3001,
                        base_path: null,
                        created_at: new Date().toISOString(),
                        updated_at: new Date().toISOString(),
                    },
                ],
                routes: [
                    {
                        id: "1",
                        collection_id: "1",
                        name: "Get Users",
                        method: "GET",
                        path: "/users",
                        status_code: 200,
                        response_body: JSON.stringify(
                            [
                                { id: 1, name: "John Doe" },
                                { id: 2, name: "Jane Smith" },
                            ],
                            null,
                            2
                        ),
                        response_headers: {
                            "Content-Type": "application/json",
                        },
                        delay_ms: 0,
                    },
                ],
                servers: [],
                runningServers: new Set() // Track which collections have running servers
            };

            const mockTauri = {
                invoke: async (command, args) => {
                    console.log("Mock Tauri command:", command, args);

                    // Mock responses
                    switch (command) {
                        case "get_collections":
                            return mockStorage.collections;
                        case "get_routes":
                            return mockStorage.routes.filter(route => route.collection_id === args.collection_id);
                        case "get_running_servers":
                            return mockStorage.collections.map(collection => ({
                                port: collection.port,
                                collection_id: collection.id,
                                collection_name: collection.name,
                                is_running: mockStorage.runningServers.has(collection.id),
                                base_url: `http://localhost:${collection.port}`
                            }));
                        case "create_collection":
                            console.log("Creating collection:", args);
                            const newCollection = { 
                                id: Date.now().toString(),
                                name: args.request.name,
                                description: args.request.description,
                                port: args.request.port,
                                base_path: args.request.base_path,
                                created_at: new Date().toISOString(),
                                updated_at: new Date().toISOString()
                            };
                            mockStorage.collections.push(newCollection);
                            return newCollection;
                        case "create_route":
                            console.log("Creating route:", args);
                            const newRoute = {
                                id: Date.now().toString(),
                                collection_id: args.collection_id,
                                name: args.name,
                                method: args.method,
                                path: args.path,
                                status_code: args.status_code,
                                response_body: args.response_body,
                                response_headers: args.response_headers,
                                delay_ms: args.delay_ms,
                                created_at: new Date().toISOString(),
                                updated_at: new Date().toISOString()
                            };
                            mockStorage.routes.push(newRoute);
                            return newRoute;
                        case "start_server":
                            console.log("Starting server for collection:", args.collection_id);
                            const targetCollection = mockStorage.collections.find(c => c.id === args.collection_id);
                            if (!targetCollection) {
                                throw new Error("Collection not found");
                            }
                            mockStorage.runningServers.add(args.collection_id);
                            return {
                                port: targetCollection.port,
                                collection_id: targetCollection.id,
                                collection_name: targetCollection.name,
                                is_running: true,
                                base_url: `http://localhost:${targetCollection.port}`
                            };
                        case "stop_server":
                            console.log("Stopping server on port:", args.port);
                            const collectionToStop = mockStorage.collections.find(c => c.port === args.port);
                            if (collectionToStop) {
                                mockStorage.runningServers.delete(collectionToStop.id);
                            }
                            return undefined;
                        case "test_route":
                            console.log("Testing route:", args.route_id);
                            const route = mockStorage.routes.find(r => r.id === args.route_id);
                            const routeCollection = route ? mockStorage.collections.find(c => c.id === route.collection_id) : null;
                            return { 
                                url: `http://localhost:${routeCollection?.port || 3000}${route?.path || '/'}`,
                                method: route?.method || "GET",
                                status_code: route?.status_code || 200, 
                                response_time_ms: Math.floor(Math.random() * 100) + 10,
                                body: route?.response_body || JSON.stringify({ message: "Test successful", data: { id: 1, name: "Test User" } }, null, 2),
                                headers: route?.response_headers || { "Content-Type": "application/json", "X-Test-Result": "success" }
                            };
                        default:
                            return { success: true };
                    }
                },
            };

            // Debug Tauri availability
            console.log("Tauri available:", !!window.__TAURI__);
            console.log("Tauri object:", window.__TAURI__);
            console.log("Tauri keys:", Object.keys(window.__TAURI__ || {}));
            
            // Try to access Tauri invoke function in different ways
            let realInvoke = null;
            
            // Check if Tauri provides invoke function automatically
            if (window.__TAURI__) {
                try {
                    // Tauri might inject invoke function automatically in development
                    if (typeof window.invoke === 'function') {
                        realInvoke = window.invoke;
                        console.log("Found invoke via window.invoke");
                    } else if (typeof window.__TAURI_INVOKE__ === 'function') {
                        realInvoke = window.__TAURI_INVOKE__;
                        console.log("Found invoke via __TAURI_INVOKE__");
                    } else {
                        // Try other possible locations
                        const tauriApi = window.__TAURI__.tauri || window.__TAURI__.core || window.__TAURI__;
                        if (tauriApi && typeof tauriApi.invoke === 'function') {
                            realInvoke = tauriApi.invoke;
                            console.log("Found invoke via Tauri API object");
                        }
                    }
                } catch (e) {
                    console.log("Error accessing Tauri API:", e);
                }
            }
            
            console.log("Real invoke found:", !!realInvoke);
            
            // Use real Tauri if available, otherwise use mock
            const tauri = {
                invoke: realInvoke || mockTauri.invoke
            };
            console.log("Using tauri:", tauri);
            console.log("Final invoke function:", realInvoke ? 'real' : 'mock');
            
            // Make invoke function available globally for debugging
            window.debugTauri = {
                isReal: !!realInvoke,
                invoke: tauri.invoke
            };

            function App() {
                console.log("App component rendering");
                const [collections, setCollections] = useState([]);
                const [selectedCollection, setSelectedCollection] = useState(null);
                const [routes, setRoutes] = useState([]);
                const [selectedRoute, setSelectedRoute] = useState(null);
                const [servers, setServers] = useState([]);
                const [showNewCollection, setShowNewCollection] = useState(false);
                const [showNewRoute, setShowNewRoute] = useState(false);
                const [testResults, setTestResults] = useState([]);
                const [expandedResults, setExpandedResults] = useState({});
                const [showTestResults, setShowTestResults] = useState(true);
                const [editingCollection, setEditingCollection] = useState(null);
                const [showEditCollection, setShowEditCollection] = useState(false);
                const [editingRoute, setEditingRoute] = useState(null);
                const [showEditRoute, setShowEditRoute] = useState(false);

                useEffect(() => {
                    console.log("App useEffect running");
                    loadCollections();
                    loadServers();
                }, []);

                useEffect(() => {
                    if (selectedCollection) {
                        loadRoutes(selectedCollection.id);
                    }
                }, [selectedCollection]);

                const loadCollections = async () => {
                    console.log("loadCollections called");
                    try {
                        console.log("Calling tauri.invoke with get_collections");
                        const data = await tauri.invoke("get_collections");
                        console.log("get_collections result:", data);
                        setCollections(data);
                        console.log("Collections state updated");
                    } catch (error) {
                        console.error("Failed to load collections:", error);
                    }
                };

                const loadRoutes = async (collectionId) => {
                    try {
                        const data = await tauri.invoke("get_routes", {
                            collectionId: collectionId,
                        });
                        setRoutes(data);
                    } catch (error) {
                        console.error("Failed to load routes:", error);
                    }
                };

                const loadServers = async () => {
                    try {
                        console.log("Loading servers...");
                        const data = await tauri.invoke("get_running_servers");
                        console.log("Server data:", data);
                        setServers(data);
                    } catch (error) {
                        console.error("Failed to load servers:", error);
                    }
                };

                const createCollection = async (collectionData) => {
                    console.log("createCollection called with:", collectionData);
                    try {
                        console.log("Calling tauri.invoke with create_collection");
                        const result = await tauri.invoke("create_collection", { request: collectionData });
                        console.log("create_collection result:", result);
                        console.log("Reloading collections...");
                        await loadCollections();
                        console.log("Collections reloaded successfully");
                    } catch (error) {
                        console.error("Failed to create collection:", error);
                    }
                };

                const updateCollection = async (collectionData) => {
                    try {
                        await tauri.invoke("update_collection", { request: collectionData });
                        await loadCollections();
                        setEditingCollection(null);
                        setShowEditCollection(false);
                    } catch (error) {
                        console.error("Failed to update collection:", error);
                    }
                };

                const deleteCollection = async (collectionId) => {
                    if (window.confirm("Are you sure you want to delete this collection? This will also delete all its routes.")) {
                        try {
                            await tauri.invoke("delete_collection", { id: collectionId });
                            await loadCollections();
                            await loadServers();
                            if (selectedCollection?.id === collectionId) {
                                setSelectedCollection(null);
                                setRoutes([]);
                            }
                        } catch (error) {
                            console.error("Failed to delete collection:", error);
                        }
                    }
                };

                const createRoute = async (routeData) => {
                    try {
                        await tauri.invoke("create_route", {
                            request: {
                                ...routeData,
                                collection_id: selectedCollection.id
                            }
                        });
                        await loadRoutes(selectedCollection.id);
                    } catch (error) {
                        console.error("Failed to create route:", error);
                    }
                };

                const updateRoute = async (routeData) => {
                    try {
                        await tauri.invoke("update_route", { request: routeData });
                        await loadRoutes(selectedCollection.id);
                        setEditingRoute(null);
                        setShowEditRoute(false);
                    } catch (error) {
                        console.error("Failed to update route:", error);
                    }
                };

                const deleteRoute = async (routeId) => {
                    if (window.confirm("Are you sure you want to delete this route?")) {
                        try {
                            await tauri.invoke("delete_route", { id: routeId });
                            await loadRoutes(selectedCollection.id);
                            if (selectedRoute?.id === routeId) {
                                setSelectedRoute(null);
                            }
                        } catch (error) {
                            console.error("Failed to delete route:", error);
                        }
                    }
                };

                const startServer = async (collectionId) => {
                    try {
                        await tauri.invoke("start_server", {
                            collectionId: collectionId,
                        });
                        await loadServers();
                    } catch (error) {
                        console.error("Failed to start server:", error);
                    }
                };

                const stopServer = async (port) => {
                    try {
                        await tauri.invoke("stop_server", { port });
                        await loadServers();
                    } catch (error) {
                        console.error("Failed to stop server:", error);
                    }
                };

                const testRoute = async (routeId) => {
                    console.log("Starting test for route:", routeId);
                    console.log("Selected route:", selectedRoute);
                    
                    try {
                        console.log("Calling tauri.invoke with test_route");
                        const result = await tauri.invoke("test_route", {
                            request: {
                                route_id: routeId,
                            }
                        });
                        console.log("Test route result:", result);
                        const testResult = {
                            id: Date.now(),
                            routeId: routeId,
                            routeName: selectedRoute?.name || 'Unknown Route',
                            method: result.method || selectedRoute?.method || 'GET',
                            path: selectedRoute?.path || '/',
                            url: result.url,
                            timestamp: new Date().toISOString(),
                            success: true,
                            status_code: result.status_code,
                            response_time_ms: result.response_time_ms,
                            response_body: result.body,
                            response_headers: result.headers,
                            error: null
                        };
                        setTestResults(prev => [testResult, ...prev]);
                        console.log("Test successful! Status:", result.status_code, "Response Time:", result.response_time_ms + "ms");
                        console.log("Test result object:", testResult);
                    } catch (error) {
                        console.error("Test route failed with error:", error);
                        console.error("Error details:", {
                            message: error.message,
                            stack: error.stack,
                            routeId: routeId,
                            selectedRoute: selectedRoute
                        });
                        const testResult = {
                            id: Date.now(),
                            routeId: routeId,
                            routeName: selectedRoute?.name || 'Unknown Route',
                            method: selectedRoute?.method || 'GET',
                            path: selectedRoute?.path || '/',
                            timestamp: new Date().toISOString(),
                            success: false,
                            status_code: null,
                            response_time_ms: null,
                            response_body: null,
                            response_headers: null,
                            error: error.message || 'Test failed'
                        };
                        setTestResults(prev => [testResult, ...prev]);
                        console.error("Test failed:", error);
                    }
                };

                return React.createElement('div', { className: 'flex h-screen' },
                    // Sidebar
                    React.createElement('div', { className: 'w-80 bg-gray-800 border-r border-gray-700 overflow-y-auto' },
                        React.createElement('div', { className: 'p-4' },
                            React.createElement('h1', { className: 'text-2xl font-bold mb-6 text-blue-400' },
                                React.createElement('i', { className: 'fas fa-server mr-2' }),
                                'Mocify'
                            ),
                            React.createElement('div', { className: 'mb-4' },
                                React.createElement('button', {
                                    onClick: () => {
                                        console.log("New Collection button clicked");
                                        setShowNewCollection(true);
                                    },
                                    className: 'w-full bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded transition'
                                },
                                    React.createElement('i', { className: 'fas fa-plus mr-2' }),
                                    'New Collection'
                                )
                            ),
                            React.createElement('h2', { className: 'text-sm font-semibold text-gray-400 uppercase mb-2' },
                                'Collections'
                            ),
                            ...collections.map(collection => {
                                const server = servers.find(s => s.collection_id === collection.id);
                                return React.createElement('div', {
                                    key: collection.id,
                                    className: `p-3 rounded mb-2 transition ${
                                        selectedCollection?.id === collection.id ? 'bg-gray-700' : 'hover:bg-gray-700'
                                    }`
                                },
                                    React.createElement('div', { 
                                        className: 'flex items-center justify-between cursor-pointer',
                                        onClick: () => setSelectedCollection(collection)
                                    },
                                        React.createElement('div', { className: 'flex items-center' },
                                            React.createElement('i', { className: 'fas fa-folder mr-2 text-yellow-500' }),
                                            React.createElement('span', null, collection.name)
                                        ),
                                        React.createElement('div', { className: 'flex items-center space-x-2' },
                                            React.createElement('span', { className: 'text-xs text-gray-400' }, ':' + collection.port),
                                            server?.is_running && React.createElement('span', { className: 'w-2 h-2 bg-green-500 rounded-full' })
                                        )
                                    ),
                                    React.createElement('div', { className: 'flex items-center justify-end space-x-1 mt-2 opacity-60 hover:opacity-100 transition-opacity' },
                                        React.createElement('button', {
                                            onClick: (e) => {
                                                e.stopPropagation();
                                                setEditingCollection(collection);
                                                setShowEditCollection(true);
                                            },
                                            className: 'text-blue-400 hover:text-blue-300 text-xs p-1',
                                            title: 'Edit Collection'
                                        },
                                            React.createElement('i', { className: 'fas fa-edit' })
                                        ),
                                        React.createElement('button', {
                                            onClick: (e) => {
                                                e.stopPropagation();
                                                deleteCollection(collection.id);
                                            },
                                            className: 'text-red-400 hover:text-red-300 text-xs p-1',
                                            title: 'Delete Collection'
                                        },
                                            React.createElement('i', { className: 'fas fa-trash' })
                                        )
                                    )
                                );
                            })
                        )
                    ),
                    
                    // Main Content
                    React.createElement('div', { className: 'flex-1 flex' },
                        // Routes List
                        React.createElement('div', { className: 'w-96 bg-gray-850 border-r border-gray-700 overflow-y-auto' },
                            selectedCollection ? React.createElement('div', { className: 'p-4' },
                                React.createElement('div', { className: 'flex items-center justify-between mb-4' },
                                    React.createElement('h2', { className: 'text-lg font-semibold' }, selectedCollection.name),
                                    React.createElement('div', { className: 'flex space-x-2' },
                                        servers.find(s => s.collection_id === selectedCollection.id)?.is_running ?
                                            React.createElement('button', {
                                                onClick: () => stopServer(selectedCollection.port),
                                                className: 'bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded text-sm transition'
                                            },
                                                React.createElement('i', { className: 'fas fa-stop mr-1' }),
                                                'Stop'
                                            ) :
                                            React.createElement('button', {
                                                onClick: () => startServer(selectedCollection.id),
                                                className: 'bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded text-sm transition'
                                            },
                                                React.createElement('i', { className: 'fas fa-play mr-1' }),
                                                'Start'
                                            )
                                    )
                                ),
                                React.createElement('button', {
                                    onClick: () => setShowNewRoute(true),
                                    className: 'w-full bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded mb-4 transition'
                                },
                                    React.createElement('i', { className: 'fas fa-plus mr-2' }),
                                    'New Route'
                                ),
                                ...routes.map(route =>
                                    React.createElement('div', {
                                        key: route.id,
                                        className: `p-3 rounded mb-2 transition ${
                                            selectedRoute?.id === route.id ? 'bg-gray-700' : 'hover:bg-gray-700'
                                        }`
                                    },
                                        React.createElement('div', { 
                                            className: 'cursor-pointer',
                                            onClick: () => setSelectedRoute(route)
                                        },
                                            React.createElement('div', { className: 'flex items-center justify-between' },
                                                React.createElement('div', null,
                                                    React.createElement('span', {
                                                        className: `inline-block w-16 text-xs font-bold mr-2 ${
                                                            route.method === 'GET' ? 'text-green-400' :
                                                            route.method === 'POST' ? 'text-blue-400' :
                                                            route.method === 'PUT' ? 'text-yellow-400' :
                                                            route.method === 'DELETE' ? 'text-red-400' : 'text-gray-400'
                                                        }`
                                                    }, route.method),
                                                    React.createElement('span', { className: 'text-sm' }, route.path)
                                                ),
                                                React.createElement('span', { className: 'text-xs text-gray-400' }, route.status_code)
                                            ),
                                            React.createElement('div', { className: 'text-xs text-gray-500 mt-1' }, route.name)
                                        ),
                                        React.createElement('div', { className: 'flex items-center justify-end space-x-1 mt-2 opacity-60 hover:opacity-100 transition-opacity' },
                                            React.createElement('button', {
                                                onClick: (e) => {
                                                    e.stopPropagation();
                                                    setEditingRoute(route);
                                                    setShowEditRoute(true);
                                                },
                                                className: 'text-blue-400 hover:text-blue-300 text-xs p-1',
                                                title: 'Edit Route'
                                            },
                                                React.createElement('i', { className: 'fas fa-edit' })
                                            ),
                                            React.createElement('button', {
                                                onClick: (e) => {
                                                    e.stopPropagation();
                                                    deleteRoute(route.id);
                                                },
                                                className: 'text-red-400 hover:text-red-300 text-xs p-1',
                                                title: 'Delete Route'
                                            },
                                                React.createElement('i', { className: 'fas fa-trash' })
                                            )
                                        )
                                    )
                                )
                            ) : React.createElement('div', { className: 'flex items-center justify-center h-full text-gray-500' },
                                React.createElement('div', { className: 'text-center' },
                                    React.createElement('i', { className: 'fas fa-folder-open text-4xl mb-2' }),
                                    React.createElement('p', null, 'Select a collection')
                                )
                            )
                        ),

                        // Route Details
                        React.createElement('div', { className: 'flex-1 bg-gray-850 overflow-y-auto' },
                            selectedRoute ? React.createElement('div', { className: 'p-6' },
                                React.createElement('div', { className: 'flex items-center justify-between mb-6' },
                                    React.createElement('h3', { className: 'text-xl font-semibold' }, selectedRoute.name),
                                    React.createElement('button', {
                                        onClick: () => testRoute(selectedRoute.id),
                                        className: 'bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded transition'
                                    },
                                        React.createElement('i', { className: 'fas fa-play mr-2' }),
                                        'Test Route'
                                    )
                                ),
                                React.createElement('div', { className: 'space-y-6' },
                                    React.createElement('div', null,
                                        React.createElement('label', { className: 'block text-sm font-medium text-gray-400 mb-2' }, 'Endpoint'),
                                        React.createElement('div', { className: 'bg-gray-800 p-3 rounded font-mono text-sm' },
                                            React.createElement('span', {
                                                className: `font-bold mr-2 ${
                                                    selectedRoute.method === 'GET' ? 'text-green-400' :
                                                    selectedRoute.method === 'POST' ? 'text-blue-400' :
                                                    selectedRoute.method === 'PUT' ? 'text-yellow-400' :
                                                    selectedRoute.method === 'DELETE' ? 'text-red-400' : 'text-gray-400'
                                                }`
                                            }, selectedRoute.method),
                                            selectedRoute.path
                                        )
                                    ),
                                    React.createElement('div', null,
                                        React.createElement('label', { className: 'block text-sm font-medium text-gray-400 mb-2' }, 'Status Code'),
                                        React.createElement('div', { className: 'bg-gray-800 p-3 rounded' },
                                            React.createElement('span', {
                                                className: `font-bold ${
                                                    selectedRoute.status_code >= 200 && selectedRoute.status_code < 300 ? 'text-green-400' :
                                                    selectedRoute.status_code >= 400 ? 'text-red-400' : 'text-yellow-400'
                                                }`
                                            }, selectedRoute.status_code)
                                        )
                                    ),
                                    selectedRoute.response_body && React.createElement('div', null,
                                        React.createElement('label', { className: 'block text-sm font-medium text-gray-400 mb-2' }, 'Response Body'),
                                        React.createElement('pre', { className: 'bg-gray-800 p-3 rounded overflow-x-auto text-sm' }, selectedRoute.response_body)
                                    ),
                                    React.createElement('div', null,
                                        React.createElement('div', { 
                                            className: 'flex items-center justify-between mb-2 cursor-pointer',
                                            onClick: () => setShowTestResults(!showTestResults)
                                        },
                                            React.createElement('label', { className: 'text-sm font-medium text-gray-400' }, 'Test Results'),
                                            React.createElement('i', { 
                                                className: `fas fa-chevron-${showTestResults ? 'down' : 'right'} text-xs text-gray-400`
                                            })
                                        ),
                                        showTestResults && React.createElement('div', { className: 'bg-gray-800 rounded max-h-80 overflow-y-auto' },
                                            testResults.filter(result => result.routeId === selectedRoute.id).length > 0 ?
                                                testResults.filter(result => result.routeId === selectedRoute.id).map(result =>
                                                    React.createElement('div', {
                                                        key: result.id,
                                                        className: `border-b border-gray-700 last:border-b-0 ${result.success ? 'border-l-4 border-l-green-500' : 'border-l-4 border-l-red-500'}`
                                                    },
                                                        React.createElement('div', { 
                                                            className: 'p-3 cursor-pointer hover:bg-gray-750',
                                                            onClick: () => setExpandedResults(prev => ({
                                                                ...prev,
                                                                [result.id]: !prev[result.id]
                                                            }))
                                                        },
                                                            React.createElement('div', { className: 'flex items-center justify-between' },
                                                                React.createElement('div', { className: 'flex items-center space-x-2' },
                                                                    React.createElement('span', {
                                                                        className: `inline-block w-2 h-2 rounded-full ${result.success ? 'bg-green-500' : 'bg-red-500'}`
                                                                    }),
                                                                    React.createElement('span', { className: 'text-xs text-gray-400' }, 
                                                                        new Date(result.timestamp).toLocaleTimeString()
                                                                    ),
                                                                    React.createElement('span', { className: 'text-xs text-gray-500 ml-2' }, 
                                                                        result.success ? 'Success' : 'Failed'
                                                                    ),
                                                                    React.createElement('i', { 
                                                                        className: `fas fa-chevron-${expandedResults[result.id] ? 'down' : 'right'} text-xs text-gray-500 ml-2`
                                                                    })
                                                                ),
                                                                React.createElement('div', { className: 'flex items-center space-x-3' },
                                                                    result.status_code && React.createElement('span', { 
                                                                        className: `text-xs font-bold ${
                                                                            result.status_code >= 200 && result.status_code < 300 ? 'text-green-400' :
                                                                            result.status_code >= 400 ? 'text-red-400' : 'text-yellow-400'
                                                                        }`
                                                                    }, result.status_code),
                                                                    result.response_time_ms && React.createElement('span', { className: 'text-xs text-gray-400' }, 
                                                                        result.response_time_ms + 'ms'
                                                                    )
                                                                )
                                                            ),
                                                            result.error && React.createElement('div', { className: 'text-xs text-red-400' }, result.error)
                                                        ),
                                                        expandedResults[result.id] && React.createElement('div', { className: 'px-3 pb-3 border-t border-gray-700' },
                                                            React.createElement('div', { className: 'space-y-3 mt-3' },
                                                                React.createElement('div', null,
                                                                    React.createElement('div', { className: 'text-xs font-medium text-gray-400 mb-1' }, 'Request'),
                                                                    React.createElement('div', { className: 'bg-gray-900 p-2 rounded text-xs font-mono' },
                                                                        React.createElement('div', null,
                                                                            React.createElement('span', { 
                                                                                className: `font-bold ${
                                                                                    result.method === 'GET' ? 'text-green-400' :
                                                                                    result.method === 'POST' ? 'text-blue-400' :
                                                                                    result.method === 'PUT' ? 'text-yellow-400' :
                                                                                    result.method === 'DELETE' ? 'text-red-400' : 'text-gray-400'
                                                                                }`
                                                                            }, result.method + ' '),
                                                                            React.createElement('span', { className: 'text-blue-300' }, result.url || (result.path || '/'))
                                                                        )
                                                                    )
                                                                ),
                                                                result.success && React.createElement('div', null,
                                                                    React.createElement('div', { className: 'text-xs font-medium text-gray-400 mb-1' }, 'Response Headers'),
                                                                    React.createElement('div', { className: 'bg-gray-900 p-2 rounded text-xs font-mono' },
                                                                        result.response_headers ? Object.entries(result.response_headers).map(([key, value]) =>
                                                                            React.createElement('div', { key: key },
                                                                                React.createElement('span', { className: 'text-blue-400' }, key + ': '),
                                                                                React.createElement('span', { className: 'text-gray-300' }, value)
                                                                            )
                                                                        ) : React.createElement('span', { className: 'text-gray-500' }, 'No headers')
                                                                    )
                                                                ),
                                                                result.success && result.response_body && React.createElement('div', null,
                                                                    React.createElement('div', { className: 'text-xs font-medium text-gray-400 mb-1' }, 'Response Body'),
                                                                    React.createElement('pre', { className: 'bg-gray-900 p-2 rounded text-xs overflow-x-auto' }, 
                                                                        result.response_body
                                                                    )
                                                                ),
                                                                result.success && React.createElement('div', null,
                                                                    React.createElement('div', { className: 'text-xs font-medium text-gray-400 mb-1' }, 'Performance'),
                                                                    React.createElement('div', { className: 'bg-gray-900 p-2 rounded text-xs' },
                                                                        React.createElement('div', { className: 'flex justify-between' },
                                                                            React.createElement('span', { className: 'text-gray-400' }, 'Status Code:'),
                                                                            React.createElement('span', { 
                                                                                className: `font-bold ${
                                                                                    result.status_code >= 200 && result.status_code < 300 ? 'text-green-400' :
                                                                                    result.status_code >= 400 ? 'text-red-400' : 'text-yellow-400'
                                                                                }`
                                                                            }, result.status_code)
                                                                        ),
                                                                        React.createElement('div', { className: 'flex justify-between' },
                                                                            React.createElement('span', { className: 'text-gray-400' }, 'Response Time:'),
                                                                            React.createElement('span', { className: 'text-blue-400' }, result.response_time_ms + 'ms')
                                                                        )
                                                                    )
                                                                )
                                                            )
                                                        )
                                                    )
                                                ) :
                                                React.createElement('div', { className: 'p-3 text-sm text-gray-500 text-center' }, 
                                                    'No test results yet. Click "Test Route" to run a test.'
                                                )
                                        )
                                    )
                                )
                            ) : React.createElement('div', { className: 'flex items-center justify-center h-full text-gray-500' },
                                React.createElement('div', { className: 'text-center' },
                                    React.createElement('i', { className: 'fas fa-route text-4xl mb-2' }),
                                    React.createElement('p', null, 'Select a route')
                                )
                            )
                        )
                    ),

                    // Modal for New Collection
                    showNewCollection && React.createElement(NewCollectionModal, {
                        show: showNewCollection,
                        onClose: () => setShowNewCollection(false),
                        onSave: createCollection
                    }),

                    // Modal for New Route
                    showNewRoute && React.createElement(NewRouteModal, {
                        show: showNewRoute,
                        onClose: () => setShowNewRoute(false),
                        onSave: createRoute
                    }),

                    // Modal for Edit Collection
                    showEditCollection && React.createElement(EditCollectionModal, {
                        show: showEditCollection,
                        collection: editingCollection,
                        onClose: () => {
                            setShowEditCollection(false);
                            setEditingCollection(null);
                        },
                        onSave: updateCollection
                    }),

                    // Modal for Edit Route
                    showEditRoute && React.createElement(EditRouteModal, {
                        show: showEditRoute,
                        route: editingRoute,
                        onClose: () => {
                            setShowEditRoute(false);
                            setEditingRoute(null);
                        },
                        onSave: updateRoute
                    })
                );
            }

            function NewCollectionModal({ show, onClose, onSave }) {
                const [name, setName] = useState("");
                const [description, setDescription] = useState("");
                const [port, setPort] = useState(3000);

                const handleSubmit = (e) => {
                    console.log("NewCollectionModal handleSubmit called");
                    e.preventDefault();
                    console.log("Form data:", { name, description, port });
                    onSave({ name, description, port });
                    setName("");
                    setDescription("");
                    setPort(3000);
                    onClose();
                };

                if (!show) return null;

                return React.createElement('div', { className: 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50' },
                    React.createElement('div', { className: 'bg-gray-800 p-6 rounded-lg w-96' },
                        React.createElement('h3', { className: 'text-lg font-semibold mb-4' }, 'New Collection'),
                        React.createElement('form', { onSubmit: handleSubmit },
                            React.createElement('div', { className: 'mb-4' },
                                React.createElement('label', { className: 'block text-sm font-medium mb-2' }, 'Name'),
                                React.createElement('input', {
                                    type: 'text',
                                    value: name,
                                    onChange: (e) => setName(e.target.value),
                                    className: 'w-full p-2 bg-gray-700 rounded',
                                    required: true
                                })
                            ),
                            React.createElement('div', { className: 'mb-4' },
                                React.createElement('label', { className: 'block text-sm font-medium mb-2' }, 'Description'),
                                React.createElement('textarea', {
                                    value: description,
                                    onChange: (e) => setDescription(e.target.value),
                                    className: 'w-full p-2 bg-gray-700 rounded',
                                    rows: 3
                                })
                            ),
                            React.createElement('div', { className: 'mb-4' },
                                React.createElement('label', { className: 'block text-sm font-medium mb-2' }, 'Port'),
                                React.createElement('input', {
                                    type: 'number',
                                    value: port,
                                    onChange: (e) => setPort(Number(e.target.value)),
                                    className: 'w-full p-2 bg-gray-700 rounded',
                                    required: true
                                })
                            ),
                            React.createElement('div', { className: 'flex justify-end space-x-2' },
                                React.createElement('button', {
                                    type: 'button',
                                    onClick: onClose,
                                    className: 'px-4 py-2 bg-gray-600 rounded hover:bg-gray-500'
                                }, 'Cancel'),
                                React.createElement('button', {
                                    type: 'submit',
                                    className: 'px-4 py-2 bg-blue-600 rounded hover:bg-blue-500'
                                }, 'Create')
                            )
                        )
                    )
                );
            }

            function NewRouteModal({ show, onClose, onSave }) {
                const [activeTab, setActiveTab] = useState("basic");
                const [name, setName] = useState("");
                const [method, setMethod] = useState("GET");
                const [path, setPath] = useState("");
                const [statusCode, setStatusCode] = useState(200);
                const [responseBody, setResponseBody] = useState("");
                const [responseHeaders, setResponseHeaders] = useState({});
                const [params, setParams] = useState([]);
                const [authType, setAuthType] = useState("none");
                const [authConfig, setAuthConfig] = useState({});

                const handleSubmit = (e) => {
                    e.preventDefault();
                    onSave({ 
                        name, 
                        method, 
                        path, 
                        status_code: statusCode, 
                        response_body: responseBody,
                        response_headers: Object.keys(responseHeaders).length > 0 ? responseHeaders : null
                    });
                    setName("");
                    setMethod("GET");
                    setPath("");
                    setStatusCode(200);
                    setResponseBody("");
                    setResponseHeaders({});
                    setParams([]);
                    setAuthType("none");
                    setAuthConfig({});
                    setActiveTab("basic");
                    onClose();
                };

                const addParam = () => {
                    setParams([...params, { key: "", value: "", description: "" }]);
                };

                const updateParam = (index, field, value) => {
                    const newParams = [...params];
                    newParams[index][field] = value;
                    setParams(newParams);
                };

                const removeParam = (index) => {
                    setParams(params.filter((_, i) => i !== index));
                };

                const addHeader = () => {
                    const key = prompt("Header name:");
                    if (key) {
                        setResponseHeaders({...responseHeaders, [key]: ""});
                    }
                };

                const updateHeader = (key, value) => {
                    setResponseHeaders({...responseHeaders, [key]: value});
                };

                const removeHeader = (key) => {
                    const newHeaders = {...responseHeaders};
                    delete newHeaders[key];
                    setResponseHeaders(newHeaders);
                };

                if (!show) return null;

                const tabs = [
                    { id: "basic", label: "Basic", icon: "fas fa-info-circle" },
                    { id: "params", label: "Params", icon: "fas fa-list" },
                    { id: "headers", label: "Headers", icon: "fas fa-file-code" },
                    { id: "auth", label: "Auth", icon: "fas fa-lock" }
                ];

                return React.createElement('div', { className: 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50' },
                    React.createElement('div', { className: 'bg-gray-800 p-6 rounded-lg w-[600px] max-h-[80vh] overflow-y-auto' },
                        React.createElement('h3', { className: 'text-lg font-semibold mb-4' }, 'New Route'),
                        
                        // Tab navigation
                        React.createElement('div', { className: 'flex border-b border-gray-600 mb-4' },
                            ...tabs.map(tab =>
                                React.createElement('button', {
                                    key: tab.id,
                                    type: 'button',
                                    onClick: () => setActiveTab(tab.id),
                                    className: `px-4 py-2 text-sm font-medium border-b-2 transition ${
                                        activeTab === tab.id 
                                            ? 'border-blue-500 text-blue-400' 
                                            : 'border-transparent text-gray-400 hover:text-gray-300'
                                    }`
                                },
                                    React.createElement('i', { className: `${tab.icon} mr-2` }),
                                    tab.label
                                )
                            )
                        ),

                        React.createElement('form', { onSubmit: handleSubmit },
                            // Basic Tab
                            activeTab === "basic" && React.createElement('div', { className: 'space-y-4' },
                                React.createElement('div', null,
                                    React.createElement('label', { className: 'block text-sm font-medium mb-2' }, 'Name'),
                                    React.createElement('input', {
                                        type: 'text',
                                        value: name,
                                        onChange: (e) => setName(e.target.value),
                                        className: 'w-full p-2 bg-gray-700 rounded',
                                        required: true
                                    })
                                ),
                                React.createElement('div', null,
                                    React.createElement('label', { className: 'block text-sm font-medium mb-2' }, 'Method'),
                                    React.createElement('select', {
                                        value: method,
                                        onChange: (e) => setMethod(e.target.value),
                                        className: 'w-full p-2 bg-gray-700 rounded'
                                    },
                                        React.createElement('option', { value: 'GET' }, 'GET'),
                                        React.createElement('option', { value: 'POST' }, 'POST'),
                                        React.createElement('option', { value: 'PUT' }, 'PUT'),
                                        React.createElement('option', { value: 'DELETE' }, 'DELETE')
                                    )
                                ),
                                React.createElement('div', null,
                                    React.createElement('label', { className: 'block text-sm font-medium mb-2' }, 'Path'),
                                    React.createElement('input', {
                                        type: 'text',
                                        value: path,
                                        onChange: (e) => setPath(e.target.value),
                                        className: 'w-full p-2 bg-gray-700 rounded',
                                        placeholder: '/api/endpoint',
                                        required: true
                                    })
                                ),
                                React.createElement('div', null,
                                    React.createElement('label', { className: 'block text-sm font-medium mb-2' }, 'Status Code'),
                                    React.createElement('input', {
                                        type: 'number',
                                        value: statusCode,
                                        onChange: (e) => setStatusCode(Number(e.target.value)),
                                        className: 'w-full p-2 bg-gray-700 rounded',
                                        required: true
                                    })
                                ),
                                React.createElement('div', null,
                                    React.createElement('label', { className: 'block text-sm font-medium mb-2' }, 'Response Body'),
                                    React.createElement('textarea', {
                                        value: responseBody,
                                        onChange: (e) => setResponseBody(e.target.value),
                                        className: 'w-full p-2 bg-gray-700 rounded',
                                        rows: 6,
                                        placeholder: '{"message": "Hello World"}'
                                    })
                                )
                            ),

                            // Params Tab
                            activeTab === "params" && React.createElement('div', { className: 'space-y-4' },
                                React.createElement('div', { className: 'flex items-center justify-between' },
                                    React.createElement('h4', { className: 'text-md font-medium' }, 'Query Parameters'),
                                    React.createElement('button', {
                                        type: 'button',
                                        onClick: addParam,
                                        className: 'bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-sm'
                                    }, 'Add Param')
                                ),
                                React.createElement('div', { className: 'space-y-2' },
                                    ...params.map((param, index) =>
                                        React.createElement('div', { 
                                            key: index, 
                                            className: 'grid grid-cols-4 gap-2 items-center'
                                        },
                                            React.createElement('input', {
                                                type: 'text',
                                                placeholder: 'Key',
                                                value: param.key,
                                                onChange: (e) => updateParam(index, 'key', e.target.value),
                                                className: 'p-2 bg-gray-700 rounded text-sm'
                                            }),
                                            React.createElement('input', {
                                                type: 'text',
                                                placeholder: 'Value',
                                                value: param.value,
                                                onChange: (e) => updateParam(index, 'value', e.target.value),
                                                className: 'p-2 bg-gray-700 rounded text-sm'
                                            }),
                                            React.createElement('input', {
                                                type: 'text',
                                                placeholder: 'Description',
                                                value: param.description,
                                                onChange: (e) => updateParam(index, 'description', e.target.value),
                                                className: 'p-2 bg-gray-700 rounded text-sm'
                                            }),
                                            React.createElement('button', {
                                                type: 'button',
                                                onClick: () => removeParam(index),
                                                className: 'text-red-400 hover:text-red-300 p-1'
                                            },
                                                React.createElement('i', { className: 'fas fa-trash' })
                                            )
                                        )
                                    ),
                                    params.length === 0 && React.createElement('p', { className: 'text-gray-500 text-sm text-center py-4' }, 
                                        'No parameters defined. Click "Add Param" to add query parameters.'
                                    )
                                )
                            ),

                            // Headers Tab
                            activeTab === "headers" && React.createElement('div', { className: 'space-y-4' },
                                React.createElement('div', { className: 'flex items-center justify-between' },
                                    React.createElement('h4', { className: 'text-md font-medium' }, 'Response Headers'),
                                    React.createElement('button', {
                                        type: 'button',
                                        onClick: addHeader,
                                        className: 'bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-sm'
                                    }, 'Add Header')
                                ),
                                React.createElement('div', { className: 'space-y-2' },
                                    ...Object.entries(responseHeaders).map(([key, value]) =>
                                        React.createElement('div', { 
                                            key: key, 
                                            className: 'grid grid-cols-3 gap-2 items-center'
                                        },
                                            React.createElement('div', { className: 'p-2 bg-gray-900 rounded text-sm font-mono' }, key),
                                            React.createElement('input', {
                                                type: 'text',
                                                placeholder: 'Value',
                                                value: value,
                                                onChange: (e) => updateHeader(key, e.target.value),
                                                className: 'p-2 bg-gray-700 rounded text-sm'
                                            }),
                                            React.createElement('button', {
                                                type: 'button',
                                                onClick: () => removeHeader(key),
                                                className: 'text-red-400 hover:text-red-300 p-1'
                                            },
                                                React.createElement('i', { className: 'fas fa-trash' })
                                            )
                                        )
                                    ),
                                    Object.keys(responseHeaders).length === 0 && React.createElement('p', { className: 'text-gray-500 text-sm text-center py-4' }, 
                                        'No headers defined. Click "Add Header" to add response headers.'
                                    )
                                )
                            ),

                            // Auth Tab
                            activeTab === "auth" && React.createElement('div', { className: 'space-y-4' },
                                React.createElement('h4', { className: 'text-md font-medium mb-4' }, 'Authentication (Coming Soon)'),
                                React.createElement('div', null,
                                    React.createElement('label', { className: 'block text-sm font-medium mb-2' }, 'Auth Type'),
                                    React.createElement('select', {
                                        value: authType,
                                        onChange: (e) => setAuthType(e.target.value),
                                        className: 'w-full p-2 bg-gray-700 rounded',
                                        disabled: true
                                    },
                                        React.createElement('option', { value: 'none' }, 'No Auth'),
                                        React.createElement('option', { value: 'basic' }, 'Basic Auth'),
                                        React.createElement('option', { value: 'bearer' }, 'Bearer Token'),
                                        React.createElement('option', { value: 'apikey' }, 'API Key')
                                    )
                                ),
                                React.createElement('p', { className: 'text-gray-500 text-sm' }, 
                                    'Authentication options will be available in a future update.'
                                )
                            ),

                            React.createElement('div', { className: 'flex justify-end space-x-2 mt-6 pt-4 border-t border-gray-600' },
                                React.createElement('button', {
                                    type: 'button',
                                    onClick: onClose,
                                    className: 'px-4 py-2 bg-gray-600 rounded hover:bg-gray-500'
                                }, 'Cancel'),
                                React.createElement('button', {
                                    type: 'submit',
                                    className: 'px-4 py-2 bg-blue-600 rounded hover:bg-blue-500'
                                }, 'Create Route')
                            )
                        )
                    )
                );
            }

            function EditRouteModal({ show, route, onClose, onSave }) {
                const [activeTab, setActiveTab] = useState("basic");
                const [name, setName] = useState(route?.name || "");
                const [method, setMethod] = useState(route?.method || "GET");
                const [path, setPath] = useState(route?.path || "");
                const [statusCode, setStatusCode] = useState(route?.status_code || 200);
                const [responseBody, setResponseBody] = useState(route?.response_body || "");
                const [responseHeaders, setResponseHeaders] = useState({});

                React.useEffect(() => {
                    if (route) {
                        setName(route.name || "");
                        setMethod(route.method || "GET");
                        setPath(route.path || "");
                        setStatusCode(route.status_code || 200);
                        setResponseBody(route.response_body || "");
                        setResponseHeaders(route.response_headers || {});
                        setActiveTab("basic");
                    }
                }, [route]);

                const handleSubmit = (e) => {
                    e.preventDefault();
                    onSave({ 
                        id: route.id,
                        name, 
                        method, 
                        path, 
                        status_code: statusCode, 
                        response_body: responseBody,
                        response_headers: Object.keys(responseHeaders).length > 0 ? responseHeaders : null
                    });
                };

                const addHeader = () => {
                    const key = prompt("Header name:");
                    if (key) {
                        setResponseHeaders({...responseHeaders, [key]: ""});
                    }
                };

                const updateHeader = (key, value) => {
                    setResponseHeaders({...responseHeaders, [key]: value});
                };

                const removeHeader = (key) => {
                    const newHeaders = {...responseHeaders};
                    delete newHeaders[key];
                    setResponseHeaders(newHeaders);
                };

                if (!show || !route) return null;

                const tabs = [
                    { id: "basic", label: "Basic", icon: "fas fa-info-circle" },
                    { id: "headers", label: "Headers", icon: "fas fa-file-code" }
                ];

                return React.createElement('div', { className: 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50' },
                    React.createElement('div', { className: 'bg-gray-800 p-6 rounded-lg w-[600px] max-h-[80vh] overflow-y-auto' },
                        React.createElement('h3', { className: 'text-lg font-semibold mb-4' }, 'Edit Route'),
                        
                        // Tab navigation
                        React.createElement('div', { className: 'flex border-b border-gray-600 mb-4' },
                            ...tabs.map(tab =>
                                React.createElement('button', {
                                    key: tab.id,
                                    type: 'button',
                                    onClick: () => setActiveTab(tab.id),
                                    className: `px-4 py-2 text-sm font-medium border-b-2 transition ${
                                        activeTab === tab.id 
                                            ? 'border-blue-500 text-blue-400' 
                                            : 'border-transparent text-gray-400 hover:text-gray-300'
                                    }`
                                },
                                    React.createElement('i', { className: `${tab.icon} mr-2` }),
                                    tab.label
                                )
                            )
                        ),

                        React.createElement('form', { onSubmit: handleSubmit },
                            // Basic Tab
                            activeTab === "basic" && React.createElement('div', { className: 'space-y-4' },
                                React.createElement('div', null,
                                    React.createElement('label', { className: 'block text-sm font-medium mb-2' }, 'Name'),
                                    React.createElement('input', {
                                        type: 'text',
                                        value: name,
                                        onChange: (e) => setName(e.target.value),
                                        className: 'w-full p-2 bg-gray-700 rounded',
                                        required: true
                                    })
                                ),
                                React.createElement('div', null,
                                    React.createElement('label', { className: 'block text-sm font-medium mb-2' }, 'Method'),
                                    React.createElement('select', {
                                        value: method,
                                        onChange: (e) => setMethod(e.target.value),
                                        className: 'w-full p-2 bg-gray-700 rounded'
                                    },
                                        React.createElement('option', { value: 'GET' }, 'GET'),
                                        React.createElement('option', { value: 'POST' }, 'POST'),
                                        React.createElement('option', { value: 'PUT' }, 'PUT'),
                                        React.createElement('option', { value: 'DELETE' }, 'DELETE')
                                    )
                                ),
                                React.createElement('div', null,
                                    React.createElement('label', { className: 'block text-sm font-medium mb-2' }, 'Path'),
                                    React.createElement('input', {
                                        type: 'text',
                                        value: path,
                                        onChange: (e) => setPath(e.target.value),
                                        className: 'w-full p-2 bg-gray-700 rounded',
                                        placeholder: '/api/endpoint',
                                        required: true
                                    })
                                ),
                                React.createElement('div', null,
                                    React.createElement('label', { className: 'block text-sm font-medium mb-2' }, 'Status Code'),
                                    React.createElement('input', {
                                        type: 'number',
                                        value: statusCode,
                                        onChange: (e) => setStatusCode(Number(e.target.value)),
                                        className: 'w-full p-2 bg-gray-700 rounded',
                                        required: true
                                    })
                                ),
                                React.createElement('div', null,
                                    React.createElement('label', { className: 'block text-sm font-medium mb-2' }, 'Response Body'),
                                    React.createElement('textarea', {
                                        value: responseBody,
                                        onChange: (e) => setResponseBody(e.target.value),
                                        className: 'w-full p-2 bg-gray-700 rounded',
                                        rows: 6,
                                        placeholder: '{"message": "Hello World"}'
                                    })
                                )
                            ),

                            // Headers Tab
                            activeTab === "headers" && React.createElement('div', { className: 'space-y-4' },
                                React.createElement('div', { className: 'flex items-center justify-between' },
                                    React.createElement('h4', { className: 'text-md font-medium' }, 'Response Headers'),
                                    React.createElement('button', {
                                        type: 'button',
                                        onClick: addHeader,
                                        className: 'bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-sm'
                                    }, 'Add Header')
                                ),
                                React.createElement('div', { className: 'space-y-2' },
                                    ...Object.entries(responseHeaders).map(([key, value]) =>
                                        React.createElement('div', { 
                                            key: key, 
                                            className: 'grid grid-cols-3 gap-2 items-center'
                                        },
                                            React.createElement('div', { className: 'p-2 bg-gray-900 rounded text-sm font-mono' }, key),
                                            React.createElement('input', {
                                                type: 'text',
                                                placeholder: 'Value',
                                                value: value,
                                                onChange: (e) => updateHeader(key, e.target.value),
                                                className: 'p-2 bg-gray-700 rounded text-sm'
                                            }),
                                            React.createElement('button', {
                                                type: 'button',
                                                onClick: () => removeHeader(key),
                                                className: 'text-red-400 hover:text-red-300 p-1'
                                            },
                                                React.createElement('i', { className: 'fas fa-trash' })
                                            )
                                        )
                                    ),
                                    Object.keys(responseHeaders).length === 0 && React.createElement('p', { className: 'text-gray-500 text-sm text-center py-4' }, 
                                        'No headers defined. Click "Add Header" to add response headers.'
                                    )
                                )
                            ),

                            React.createElement('div', { className: 'flex justify-end space-x-2 mt-6 pt-4 border-t border-gray-600' },
                                React.createElement('button', {
                                    type: 'button',
                                    onClick: onClose,
                                    className: 'px-4 py-2 bg-gray-600 rounded hover:bg-gray-500'
                                }, 'Cancel'),
                                React.createElement('button', {
                                    type: 'submit',
                                    className: 'px-4 py-2 bg-blue-600 rounded hover:bg-blue-500'
                                }, 'Update Route')
                            )
                        )
                    )
                );
            }

            function EditCollectionModal({ show, collection, onClose, onSave }) {
                const [name, setName] = useState(collection?.name || "");
                const [description, setDescription] = useState(collection?.description || "");
                const [port, setPort] = useState(collection?.port || 3000);

                React.useEffect(() => {
                    if (collection) {
                        setName(collection.name || "");
                        setDescription(collection.description || "");
                        setPort(collection.port || 3000);
                    }
                }, [collection]);

                const handleSubmit = (e) => {
                    e.preventDefault();
                    onSave({ 
                        id: collection.id,
                        name, 
                        description: description || null, 
                        port 
                    });
                };

                if (!show || !collection) return null;

                return React.createElement('div', { className: 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50' },
                    React.createElement('div', { className: 'bg-gray-800 p-6 rounded-lg w-96' },
                        React.createElement('h3', { className: 'text-lg font-semibold mb-4' }, 'Edit Collection'),
                        React.createElement('form', { onSubmit: handleSubmit },
                            React.createElement('div', { className: 'mb-4' },
                                React.createElement('label', { className: 'block text-sm font-medium mb-2' }, 'Name'),
                                React.createElement('input', {
                                    type: 'text',
                                    value: name,
                                    onChange: (e) => setName(e.target.value),
                                    className: 'w-full p-2 bg-gray-700 rounded',
                                    required: true
                                })
                            ),
                            React.createElement('div', { className: 'mb-4' },
                                React.createElement('label', { className: 'block text-sm font-medium mb-2' }, 'Description'),
                                React.createElement('textarea', {
                                    value: description,
                                    onChange: (e) => setDescription(e.target.value),
                                    className: 'w-full p-2 bg-gray-700 rounded',
                                    rows: 3
                                })
                            ),
                            React.createElement('div', { className: 'mb-4' },
                                React.createElement('label', { className: 'block text-sm font-medium mb-2' }, 'Port'),
                                React.createElement('input', {
                                    type: 'number',
                                    value: port,
                                    onChange: (e) => setPort(Number(e.target.value)),
                                    className: 'w-full p-2 bg-gray-700 rounded',
                                    required: true
                                })
                            ),
                            React.createElement('div', { className: 'flex justify-end space-x-2' },
                                React.createElement('button', {
                                    type: 'button',
                                    onClick: onClose,
                                    className: 'px-4 py-2 bg-gray-600 rounded hover:bg-gray-500'
                                }, 'Cancel'),
                                React.createElement('button', {
                                    type: 'submit',
                                    className: 'px-4 py-2 bg-blue-600 rounded hover:bg-blue-500'
                                }, 'Update')
                            )
                        )
                    )
                );
            }

            console.log("Creating root...");
            const root = createRoot(document.getElementById('root'));
            console.log("Rendering App...");
            root.render(React.createElement(App));
            console.log("App rendered!");
        </script>
    </body>
</html>